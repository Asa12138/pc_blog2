---
title: å®åŸºå› ç»„åˆ†ç®±ï¼ˆbinningï¼‰ï½œ1.Metabatå®æˆ˜äº†è§£binning
author: Peng Chen
date: '2024-05-29'
slug: binning
categories:
  - metagenomic
tags:
  - microbiome
  - binning
description: å®åŸºå› ç»„åˆ†ç®±ï¼ˆMetagenomics Binningï¼‰æ˜¯ä¸€ä¸ªå°†å®åŸºå› ç»„æµ‹åºè·å¾—çš„DNAåºåˆ—åˆ†ç±»ä¸ºç¦»æ•£ç»„æˆ–â€œbinsâ€çš„è¿‡ç¨‹ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å…ˆä»MetaBATè®²èµ·ï¼Œé€šè¿‡MetaBAT2å®æˆ˜æ¥äº†è§£åˆ†ç®±æµç¨‹ã€‚
image: images/binning.png
math: ~
license: ~
hidden: no
comments: yes
---

```{r include=FALSE}
Packages <- c("dplyr","kableExtra","ggplot2")
pcutils::lib_ps(Packages)
knitr::opts_chunk$set(message = FALSE,warning = FALSE,eval = FALSE)
```

## Introduction

å®åŸºå› ç»„å­¦æ˜¯ç›´æ¥ä»ç¯å¢ƒæ ·æœ¬ï¼ˆå¦‚åœŸå£¤ã€æ°´ã€è‚ é“å†…å®¹ç‰©ç­‰ï¼‰ä¸­å›æ”¶é—ä¼ ç‰©è´¨å¹¶è¿›è¡Œç ”ç©¶çš„å­¦ç§‘ï¼Œæ— éœ€å¯¹ä¸ªä½“ç”Ÿç‰©è¿›è¡Œåˆ†ç¦»æˆ–åŸ¹å…»ã€‚è¿™ä¸€é¢†åŸŸçš„ç ”ç©¶ä¸ºæˆ‘ä»¬æä¾›äº†å¯¹å¾®ç”Ÿç‰©ç¾¤è½å¤šæ ·æ€§åŠå…¶åŠŸèƒ½çš„æ·±å…¥ç†è§£ã€‚å¯ä»¥æŸ¥çœ‹æˆ‘ä¹‹å‰å†™çš„[å®åŸºå› ç»„åˆ†ææµç¨‹](https://asa-blog.netlify.app/p/metagenomic-workflow)ï¼Œå½“æ—¶æƒ³ç€åœ¨å¦ä¸€ç¯‡é‡Œä»‹ç»binningï¼Œç»“æœæ‹–äº†ä¸€å¹´ï¼Œå“ˆå“ˆğŸ˜‚ï¼Œç°åœ¨è¡¥ä¸Šã€‚

å®åŸºå› ç»„åˆ†ç®±ï¼ˆMetagenomics Binningï¼‰æ˜¯ä¸€ä¸ªå°†å®åŸºå› ç»„æµ‹åºè·å¾—çš„DNAåºåˆ—åˆ†ç±»ä¸ºç¦»æ•£ç»„æˆ–â€œbinsâ€çš„è¿‡ç¨‹ï¼Œè¿™äº›ç»„åŸºäºåºåˆ—é—´çš„ç›¸ä¼¼æ€§æ¥å®šä¹‰ã€‚åˆ†ç®±çš„ç›®çš„æ˜¯å°†DNAåºåˆ—åˆ†é…ç»™å…¶æ¥æºçš„ç”Ÿç‰©æˆ–åˆ†ç±»ç¾¤ï¼Œä»è€Œæ›´å¥½åœ°äº†è§£æ ·æœ¬ä¸­å­˜åœ¨çš„å¾®ç”Ÿç‰©ç¾¤è½çš„å¤šæ ·æ€§å’ŒåŠŸèƒ½ã€‚

![](images/binning.png)

åˆ†ç®±å¾—åˆ°çš„è¾ƒé«˜è´¨é‡binsä¹Ÿå¯ä»¥ç§°ä¸ºæˆ‘ä»¬ç»å¸¸è¯´çš„MAGsï¼ˆMetagenome-Assembled Genomesï¼Œå®åŸºå› ç»„ç»„è£…åŸºå› ç»„ï¼‰æˆ–è€…draft genomeï¼ŒMAGsä»£è¡¨ä»å®åŸºå› ç»„æ•°æ®ä¸­ç»„è£…å¹¶åˆ†ç®±å‡ºæ¥çš„å®Œæ•´æˆ–å‡ ä¹å®Œæ•´çš„åŸºå› ç»„ã€‚å› ä¸ºè®¸å¤šå¾®ç”Ÿç‰©æ— æ³•é€šè¿‡ä¼ ç»Ÿçš„åŸ¹å…»æ–¹æ³•è¿›è¡Œç ”ç©¶ï¼ŒMAGsåœ¨ç¯å¢ƒå¾®ç”Ÿç‰©å­¦ç ”ç©¶ä¸­éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥åšåç»­çš„å¾ˆå¤šæ·±å…¥åˆ†ææ¯”å¦‚BGCsï¼Œè¿›åŒ–åˆ†æç­‰ã€‚

### å¸¸ç”¨æ–¹æ³•

å®åŸºå› ç»„åˆ†ç®±æœ‰å‡ ç§æ–¹æ³•ï¼ŒåŒ…æ‹¬ï¼š

- **åŸºäºåºåˆ—ç»„æˆçš„åˆ†ç®±**ï¼šè¿™ç§æ–¹æ³•åŸºäºä¸åŒåŸºå› ç»„å…·æœ‰ç‹¬ç‰¹çš„åºåˆ—ç»„æˆæ¨¡å¼ï¼ˆå¦‚GCå«é‡æˆ–å¯†ç å­ä½¿ç”¨åå¥½ï¼‰çš„è§‚å¯Ÿã€‚é€šè¿‡åˆ†æå®åŸºå› ç»„æ•°æ®ä¸­çš„è¿™äº›æ¨¡å¼ï¼Œå¯ä»¥å°†åºåˆ—ç‰‡æ®µåˆ†é…åˆ°å•ä¸ªåŸºå› ç»„æˆ–åŸºå› ç»„ç»„ã€‚
- **åŸºäºè¦†ç›–åº¦çš„åˆ†ç®±**ï¼šè¿™ç§æ–¹æ³•åˆ©ç”¨æµ‹åºè¯»æ®µçš„è¦†ç›–æ·±åº¦å°†å®ƒä»¬åˆ†ç»„ã€‚æ¥è‡ªåŒä¸€åŸºå› ç»„çš„æµ‹åºè¯»æ®µé¢„æœŸå…·æœ‰ç›¸ä¼¼çš„è¦†ç›–åº¦ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥ç”¨æ¥è¯†åˆ«ä»£è¡¨å•ä¸ªåŸºå› ç»„æˆ–åŸºå› ç»„ç°‡çš„è¯»æ®µç»„ã€‚
- **æ··åˆåˆ†ç®±**ï¼šè¿™ç§æ–¹æ³•ç»“åˆäº†åŸºäºåºåˆ—ç»„æˆå’ŒåŸºäºè¦†ç›–åº¦çš„åˆ†ç®±ï¼Œä»¥æé«˜åˆ†ç®±ç»“æœçš„å‡†ç¡®æ€§ã€‚é€šè¿‡ä½¿ç”¨å¤šç§ä¿¡æ¯æºï¼Œæ··åˆåˆ†ç®±å¯ä»¥æ›´å¥½åœ°åŒºåˆ†åºåˆ—ç»„æˆæ¨¡å¼ç›¸ä¼¼çš„è¿‘ç¼˜åŸºå› ç»„ã€‚
- **åŸºäºèšç±»çš„åˆ†ç®±**ï¼šè¿™ç§æ–¹æ³•æ ¹æ®åºåˆ—ç›¸ä¼¼æ€§å°†åºåˆ—ç‰‡æ®µåˆ†ä¸ºå¤šä¸ªç°‡ï¼Œç„¶åæ ¹æ®å…¶åºåˆ—ç»„æˆå’Œè¦†ç›–åº¦å°†æ¯ä¸ªç°‡åˆ†é…åˆ°ä¸€ä¸ªåŸºå› ç»„æˆ–åŸºå› ç»„ç°‡ã€‚æ­¤æ–¹æ³•å¯¹äºå…·æœ‰é«˜åŸºå› ç»„å¤šæ ·æ€§çš„å®åŸºå› ç»„æ•°æ®é›†ç‰¹åˆ«æœ‰ç”¨ã€‚
- **åŸºäºç›‘ç£æœºå™¨å­¦ä¹ çš„åˆ†ç®±**ï¼šè¿™ç§æ–¹æ³•ä½¿ç”¨åœ¨æ³¨é‡Šå‚è€ƒåŸºå› ç»„ä¸Šè®­ç»ƒçš„æœºå™¨å­¦ä¹ ç®—æ³•æ¥å°†å®åŸºå› ç»„æ•°æ®åˆ†ç±»åˆ°å„ä¸ªåˆ†ç®±ã€‚è¿™ç§æ–¹æ³•å¯ä»¥å®ç°é«˜å‡†ç¡®æ€§ï¼Œä½†éœ€è¦å¤§é‡çš„æ³¨é‡ŠåŸºå› ç»„è¿›è¡Œè®­ç»ƒã€‚

è¿™äº›æ–¹æ³•éƒ½æœ‰å…¶ä¼˜ç‚¹å’Œå±€é™æ€§ï¼Œåˆ†ç®±æ–¹æ³•çš„é€‰æ‹©å–å†³äºå®åŸºå› ç»„æ•°æ®é›†çš„å…·ä½“ç‰¹å¾å’Œæ‰€è§£å†³çš„ç ”ç©¶é—®é¢˜ã€‚

### å­˜åœ¨æŒ‘æˆ˜

å®åŸºå› ç»„åˆ†ç®±æ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ï¼Œæ¶‰åŠè®¸å¤šæ­¥éª¤ï¼Œç”±äºè¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°çš„å¤šä¸ªé—®é¢˜ï¼Œè¿™ä¸€è¿‡ç¨‹å……æ»¡æŒ‘æˆ˜ã€‚å®åŸºå› ç»„åˆ†ç®±ä¸­å¸¸è§çš„ä¸€äº›é—®é¢˜åŒ…æ‹¬ï¼š

- **é«˜å¤æ‚æ€§**ï¼šå®åŸºå› ç»„æ ·æœ¬åŒ…å«æ¥è‡ªå¤šä¸ªç”Ÿç‰©çš„DNAï¼Œè¿™ä¼šå¯¼è‡´æ•°æ®çš„é«˜å¤æ‚æ€§ã€‚
- **ç‰‡æ®µåŒ–åºåˆ—**ï¼šå®åŸºå› ç»„æµ‹åºé€šå¸¸ç”Ÿæˆç‰‡æ®µåŒ–çš„åºåˆ—ï¼Œè¿™ä½¿å¾—å°†è¯»æ®µåˆ†é…åˆ°æ­£ç¡®çš„åˆ†ç®±å˜å¾—å›°éš¾ã€‚
- **è¦†ç›–åº¦ä¸å‡**ï¼šå®åŸºå› ç»„æ ·æœ¬ä¸­çš„ä¸€äº›ç”Ÿç‰©å¯èƒ½æ¯”å…¶ä»–ç”Ÿç‰©æ›´ä¸°å¯Œï¼Œå¯¼è‡´ä¸åŒåŸºå› ç»„çš„è¦†ç›–åº¦ä¸å‡ã€‚
- **ä¸å®Œæ•´æˆ–éƒ¨åˆ†åŸºå› ç»„**ï¼šå®åŸºå› ç»„æµ‹åºå¯èƒ½æ— æ³•æ•è·æŸä¸ªç”Ÿç‰©çš„å®Œæ•´åŸºå› ç»„ï¼Œè¿™ä½¿å¾—å‡†ç¡®åˆ†ç®±è¯¥ç”Ÿç‰©çš„åºåˆ—å˜å¾—å›°éš¾ã€‚
- **æ°´å¹³åŸºå› è½¬ç§»**ï¼šæ°´å¹³åŸºå› è½¬ç§»ï¼ˆHGTï¼‰å¯ä»¥ä½¿ä¸€ä¸ªç”Ÿç‰©çš„é—ä¼ ç‰©è´¨å¼•å…¥åˆ°å¦ä¸€ä¸ªç”Ÿç‰©ä¸­ï¼Œä»è€Œä½¿å®åŸºå› ç»„åˆ†ç®±å˜å¾—å¤æ‚ã€‚
- **åµŒåˆåºåˆ—**ï¼šç”±äºæµ‹åºé”™è¯¯æˆ–æ±¡æŸ“äº§ç”Ÿçš„åµŒåˆåºåˆ—ï¼Œä¼šä½¿å¾—å‡†ç¡®åˆ†ç®±è¯»æ®µå˜å¾—å›°éš¾ã€‚
- **èŒæ ªå˜å¼‚**ï¼šåŒä¸€ç‰©ç§å†…çš„ç”Ÿç‰©å¯ä»¥è¡¨ç°å‡ºæ˜¾è‘—çš„é—ä¼ å˜å¼‚ï¼Œè¿™ä½¿å¾—åŒºåˆ†å®åŸºå› ç»„æ ·æœ¬ä¸­ä¸åŒçš„èŒæ ªå˜å¾—å›°éš¾ã€‚

### å¸¸ç”¨è½¯ä»¶

æœ‰è®¸å¤šè®¡ç®—å·¥å…·å¯ä»¥æ‰§è¡Œå®åŸºå› ç»„åˆ†ç®±ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æœ€å¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼š

1. **MaxBin (Wu et al. 2015)**ï¼š
   - ä¸€ç§æµè¡Œçš„ä»å¤´åˆ†ç®±ç®—æ³•ï¼Œä½¿ç”¨åºåˆ—ç‰¹å¾å’Œæ ‡è®°åŸºå› çš„ç»„åˆå°†é‡å ç¾¤èšç±»åˆ°åŸºå› ç»„ç®±ä¸­ã€‚
2. **MetaBAT2ï¼ˆKang ç­‰äººï¼Œ2019ï¼‰**ï¼š
   - å¦ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„ä»å¤´åˆ†ç®±ç®—æ³•ï¼Œé‡‡ç”¨åŸºäºå››æ ¸è‹·é…¸é¢‘ç‡å’Œè¦†ç›–ä¿¡æ¯çš„åˆ†å±‚èšç±»æ–¹æ³•ã€‚
3. **CONCOCTï¼ˆAlneberg et al. 2014ï¼‰**ï¼š
   - ä¸€ç§ä»å¤´åˆ†ç®±å·¥å…·ï¼Œä½¿ç”¨åŸºäºåºåˆ—ç»„æˆå’Œè¦†ç›–ä¿¡æ¯çš„èšç±»ç®—æ³•å°†é‡å ç¾¤åˆ†ç»„åˆ°åŸºå› ç»„ç®±ä¸­ã€‚
4. **MyCC (Lin and Liao 2016)**ï¼š
   - ä¸€ç§åŸºäºå‚è€ƒçš„åˆ†ç®±å·¥å…·ï¼Œä½¿ç”¨åºåˆ—æ¯”å¯¹æ¥è¯†åˆ«å±äºåŒä¸€åŸºå› ç»„æˆ–åˆ†ç±»ç»„çš„é‡å ç¾¤ã€‚
5. **GroopM (Imelfort et al. 2014)**ï¼š
   - ä¸€ç§æ··åˆåˆ†ç®±å·¥å…·ï¼Œç»“åˆäº†åŸºäºå‚è€ƒå’Œä»å¤´æ–¹æ³•æ¥å®ç°é«˜åˆ†ç®±ç²¾åº¦ã€‚
6. **MetaWRAP (Uritskiy et al. 2018)**ï¼š
   - ä¸€ä¸ªå…¨é¢çš„å®åŸºå› ç»„åˆ†ææµç¨‹ï¼ŒåŒ…æ‹¬ç”¨äºè´¨é‡æ§åˆ¶ã€ç»„è£…ã€åˆ†ç®±å’Œæ³¨é‡Šçš„å„ç§æ¨¡å—ã€‚
7. **Anviâ€™o (Eren et al. 2015)**ï¼š
   - ä¸€ä¸ªç”¨äºå¯è§†åŒ–å’Œåˆ†æå®åŸºå› ç»„æ•°æ®çš„å¹³å°ï¼ŒåŒ…æ‹¬åˆ†ç®±ã€æ³¨é‡Šå’Œæ¯”è¾ƒåŸºå› ç»„å­¦çš„åŠŸèƒ½ã€‚
8. **SemiBin (Pan et al. 2022)**ï¼š
   - ä¸€ç§åˆ©ç”¨æ·±åº¦å­¦ä¹ è¿›è¡Œå®åŸºå› ç»„åˆ†ç®±çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå¯å¤„ç†çŸ­è¯»å’Œé•¿è¯»ã€‚

Sczyrbaç­‰äººåœ¨2017å¹´è¿›è¡Œäº†ä¸€é¡¹åŸºå‡†æµ‹è¯•ç ”ç©¶ï¼Œå¯¹å¤šç§å®åŸºå› ç»„åˆ†ç®±å·¥å…·çš„æ€§èƒ½è¿›è¡Œäº†è¯„ä¼°ã€‚ä»–ä»¬å‘ç°ï¼ŒMetabat2åœ¨å‡†ç¡®æ€§å’Œè®¡ç®—æ•ˆç‡æ–¹é¢å‡ä¼˜äºä»¥å‰çš„MetaBATå’Œå…¶ä»–æ›¿ä»£æ–¹æ¡ˆã€‚æ‰€æœ‰è¿™äº›è¯„ä¼°éƒ½æ˜¯åŸºäºé»˜è®¤å‚æ•°è¿›è¡Œçš„ï¼ˆSczyrba et al. 2017ï¼‰ã€‚

MetaWRAPæ˜¯ä¸€ä¸ªéå¸¸å…¨é¢è¯¦ç»†çš„æµç¨‹ï¼ŒåŒ…å«äº†binningä¸Šä¸‹æ¸¸çš„å„ç§åˆ†æï¼Œè¿˜æ•´åˆäº†ä¸‰ç§è½¯ä»¶çš„binningç»“æœï¼Œå¯¹äºåˆšå¼€å§‹å­¦ä¹ binningçš„æ ¸å¿ƒæ­¥éª¤å¯èƒ½ä¸æ˜¯å¾ˆåˆé€‚ã€‚
æ‰€ä»¥æˆ‘æƒ³å…ˆä»MetaBATè®²èµ·ï¼Œé€šè¿‡MetaBAT2å®æˆ˜æ¥äº†è§£åˆ†ç®±æµç¨‹ã€‚

**å‚è€ƒæ•™ç¨‹ï¼š**

Nikolaos Pechlivanis, Fotis E. Psomopoulos, Binning of metagenomic sequencing data (Galaxy Training Materials). <https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/metagenomics-binning/tutorial.html> Online; accessed Wed May 29 2024

## Metabatå®æˆ˜

ä»¥ä¸‹æè¿°æ¥è‡ªMetaBatåœ¨Bioinformaticså‘è¡¨çš„è®ºæ–‡ï¼š

>Grouping large fragments assembled from shotgun metagenomic sequences to deconvolute complex microbial communities, or metagenome binning, enables the study of individual organisms and their interactions. Here we developed automated metagenome binning software, called MetaBAT, which integrates empirical probabilistic distances of genome abundance and tetranucleotide frequency. On synthetic datasets MetaBAT on average achieves 98percent precision and 90% recall at the strain level with 281 near complete unique genomes. Applying MetaBAT to a human gut microbiome data set we recovered 176 genome bins with 92% precision and 80% recall. Further analyses suggest MetaBAT is able to recover genome fragments missed in reference genomes up to 19%, while 53 genome bins are novel. In summary, we believe MetaBAT is a powerful tool to facilitate comprehensive understanding of complex microbial communities.
â€” Kang et al, 2019

### è½¯ä»¶ï¼Œæ•°æ®å‡†å¤‡

ä½¿ç”¨condaå®‰è£…Metabat2éå¸¸ç®€å•ï¼š

```bash
conda install -c bioconda metabat2
```

å¦å¤–æˆ‘ä»¬å®‰è£…ä¸€ä¸‹åç»­ä¼šç”¨åˆ°çš„dRepå’ŒCheckM

```bash
conda install drep checkm-genome -y
```

CheckMéœ€è¦ä¸‹è½½å¯¹åº”æ•°æ®åº“ï¼š<https://data.ace.uq.edu.au/public/CheckM_databases>å¹¶é…ç½®ç¯å¢ƒå˜é‡ï¼š

`checkm data setRoot <checkm_data_dir>`

æœ¬æ–‡ä½¿ç”¨çš„ç¤ºä¾‹æ•°æ®æ¥è‡ª<https://zenodo.org/records/7818827>ï¼Œè¿™æ˜¯åŸºäºå’–å•¡å‘é…µç³»ç»Ÿç ”ç©¶çš„6ä¸ªåŸå§‹æ•°æ®é›†ç”Ÿæˆçš„æ¨¡æ‹Ÿæ•°æ®é›†ã€‚

é‡Œé¢å·²ç»æä¾›äº†åŒç«¯fastqæµ‹åºæ–‡ä»¶å’Œç»„è£…å¥½çš„contigsï¼Œæˆ‘ä»¬ç›´æ¥ä¸‹è½½ä¸‹åˆ—é“¾æ¥å³å¯ï¼š

```
https://zenodo.org/api/records/7818827/files-archive
```

### Binning

Metabat2 éœ€è¦ä»¥ç»„è£…çš„contigsï¼ˆfastaæ ¼å¼ï¼‰å’Œè¦†ç›–ä¿¡æ¯ï¼ˆbamæ ¼å¼ï¼‰çš„å½¢å¼è¾“å…¥å®åŸºå› ç»„æµ‹åºæ•°æ®ã€‚å…·ä½“è€Œè¨€ï¼ŒMetabat2 éœ€è¦ä¸¤ä¸ªè¾“å…¥æ–‡ä»¶ï¼š

1. **fastaæ–‡ä»¶**ï¼šåŒ…å«ç»„è£…çš„contigsï¼Œå¯ä»¥ä½¿ç”¨MEGAHITã€SPAdesæˆ–IDBA-UDç­‰ç»„è£…å·¥å…·ä»åŸå§‹å®åŸºå› ç»„æµ‹åºè¯»æ®µç”Ÿæˆã€‚

2. **bamæ–‡ä»¶**ï¼šåŒ…å«æ¯ä¸ªcontigçš„è¯»æ®µè¦†ç›–ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨Bowtie2æˆ–BWAç­‰æ¯”å¯¹è½¯ä»¶ä»ç›¸åŒçš„æµ‹åºè¯»æ®µç”Ÿæˆã€‚

æ­¤å¤–ï¼ŒMetabat2 è¿˜éœ€è¦ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œç”¨äºæŒ‡å®šåˆ†ç®±è¿‡ç¨‹çš„å„ç§å‚æ•°å’Œé€‰é¡¹ï¼Œå¦‚æœ€å°contigé•¿åº¦ã€è¦ç”Ÿæˆçš„æœ€å¤§ç°‡æ•°ä»¥åŠæœ€å¤§é¢„æœŸæ±¡æŸ“æ°´å¹³ã€‚

å…·ä½“æµç¨‹ï¼š

1. **ç»„è£…contigs**ï¼š
   - ä½¿ç”¨MEGAHITã€SPAdesæˆ–IDBA-UDç­‰å·¥å…·ç»„è£…æµ‹åºè¯»æ®µï¼Œç”Ÿæˆcontigs.fastaæ–‡ä»¶ã€‚
   ```bash
   megahit -1 reads_1.fq -2 reads_2.fq -o output_dir
   ```

2. **ç”Ÿæˆè¦†ç›–ä¿¡æ¯**ï¼š
   - ä½¿ç”¨Bowtie2æˆ–BWAå°†è¯»æ®µæ¯”å¯¹åˆ°ç»„è£…çš„contigsä¸Šï¼Œå¹¶ç”Ÿæˆbamæ–‡ä»¶ã€‚
   ```bash
   bowtie2-build contigs.fasta contigs
   bowtie2 -x contigs -1 reads_1.fq -2 reads_2.fq -S alignment.sam
   samtools view -bS alignment.sam > alignment.bam
   samtools sort alignment.bam -o sorted_alignment.bam
   samtools index sorted_alignment.bam
   ```
   
3. **ç”Ÿæˆè¦†ç›–æ·±åº¦æ–‡ä»¶**ï¼š
   - ä½¿ç”¨MetaBATæä¾›çš„å·¥å…·è®¡ç®—æ¯ä¸ªcontigçš„è¦†ç›–æ·±åº¦ã€‚
   ```bash
   jgi_summarize_bam_contig_depths --outputDepth depth.txt sorted_alignment.bam
   ```
   
4. **è¿è¡ŒMetabat2**ï¼š
   - ä½¿ç”¨Metabat2è¿›è¡Œåˆ†ç®±ã€‚
   ```bash
   metabat2 -i contigs.fasta -a depth.txt -o bins_dir/bin
   ```

5. **é…ç½®æ–‡ä»¶**ï¼š
   - Metabat2 å¯ä»¥ä½¿ç”¨é»˜è®¤å‚æ•°è¿›è¡Œè¿è¡Œï¼Œä½†ç”¨æˆ·ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶æŒ‡å®šå‚æ•°ï¼Œå¦‚æœ€å°contigé•¿åº¦ã€æœ€å¤§ç°‡æ•°å’Œæœ€å¤§é¢„æœŸæ±¡æŸ“æ°´å¹³ã€‚é…ç½®æ–‡ä»¶çš„å†…å®¹ç¤ºä¾‹å¦‚ä¸‹ï¼š
   ```plaintext
   minContig 1500
   maxClusters 200
   maxExpectedContamination 10
   ```
   
åˆ†åˆ«å¯¹ä¸Šè¿°6ä¸ªæ ·æœ¬è·‘è¿™ä¸ªæµç¨‹ï¼ŒMetaBAT 2ç”Ÿæˆçš„è¾“å‡ºæ–‡ä»¶åŒ…æ‹¬ï¼ˆä»¥ä¸‹æŸäº›æ–‡ä»¶æ˜¯å¯é€‰çš„ï¼Œåªæœ‰åœ¨ç”¨æˆ·éœ€è¦æ—¶æ‰ä¼šç”Ÿæˆï¼‰ï¼š

1. **æœ€ç»ˆçš„åŸºå› ç»„åˆ†ç®±ï¼ˆFASTAæ ¼å¼ï¼‰**ï¼ˆ.faæ–‡ä»¶ï¼‰ï¼šåŒ…å«åˆ†ç®±ç»“æœçš„åŸºå› ç»„åºåˆ—ã€‚
2. **æ€»ç»“æ–‡ä»¶**ï¼ˆ.txtæ–‡ä»¶ï¼‰ï¼šåŒ…å«æ¯ä¸ªåŸºå› ç»„åˆ†ç®±çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å…¶é•¿åº¦ã€å®Œæ•´æ€§ã€æ±¡æŸ“åº¦å’Œåˆ†ç±»ä¿¡æ¯ã€‚
3. **æ˜ å°„ç»“æœæ–‡ä»¶**ï¼ˆ.bamæ–‡ä»¶ï¼‰ï¼šæ˜¾ç¤ºæ¯ä¸ªcontigå¦‚ä½•è¢«åˆ†é…åˆ°åŸºå› ç»„åˆ†ç®±ã€‚
4. **åŸºå› ç»„åˆ†ç®±ä¸°åº¦ä¼°ç®—æ–‡ä»¶**ï¼ˆ.txtæ–‡ä»¶ï¼‰ï¼šåŒ…å«æ¯ä¸ªåŸºå› ç»„åˆ†ç®±çš„ä¸°åº¦ä¼°ç®—ä¿¡æ¯ã€‚
5. **åŸºå› ç»„åˆ†ç®±è¦†ç›–ç‡æ–‡ä»¶**ï¼ˆ.txtæ–‡ä»¶ï¼‰ï¼šåŒ…å«æ¯ä¸ªåŸºå› ç»„åˆ†ç®±çš„è¦†ç›–ç‡ä¿¡æ¯ã€‚
6. **åŸºå› ç»„åˆ†ç®±çš„æ ¸è‹·é…¸ç»„æˆæ–‡ä»¶**ï¼ˆ.txtæ–‡ä»¶ï¼‰ï¼šåŒ…å«æ¯ä¸ªåŸºå› ç»„åˆ†ç®±çš„æ ¸è‹·é…¸ç»„æˆä¿¡æ¯ã€‚
7. **é¢„æµ‹çš„åŸºå› åºåˆ—æ–‡ä»¶**ï¼ˆ.faaæ–‡ä»¶ï¼‰ï¼šåŒ…å«æ¯ä¸ªåŸºå› ç»„åˆ†ç®±çš„é¢„æµ‹åŸºå› åºåˆ—ã€‚

è¾“å‡ºæ–‡ä»¶ç¤ºä¾‹ï¼š

1. **åŸºå› ç»„åˆ†ç®±æ–‡ä»¶ï¼ˆ.faï¼‰**ï¼š
   - åŒ…å«åˆ†ç®±åçš„åŸºå› ç»„åºåˆ—ï¼Œæ¯ä¸ªæ–‡ä»¶ä»£è¡¨ä¸€ä¸ªåŸºå› ç»„binã€‚
   ```plaintext
   >bin1_contig1
   ATGCGT...
   >bin1_contig2
   ATGCGT...
   ```

2. **æ€»ç»“æ–‡ä»¶ï¼ˆ.txtï¼‰**ï¼š
   - åŒ…å«æ¯ä¸ªåŸºå› ç»„åˆ†ç®±çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚é•¿åº¦ã€å®Œæ•´æ€§ã€æ±¡æŸ“åº¦ç­‰ã€‚
   ```plaintext
   Bin ID    Length    Completeness    Contamination    Taxonomy
   bin1      3.2 Mb    95%             2%               Bacteria
   bin2      4.1 Mb    90%             5%               Archaea
   ```

3. **æ˜ å°„ç»“æœæ–‡ä»¶ï¼ˆ.bamï¼‰**ï¼š
   - åŒ…å«contigså¦‚ä½•è¢«åˆ†é…åˆ°åŸºå› ç»„åˆ†ç®±çš„æ˜ å°„ä¿¡æ¯ã€‚

4. **ä¸°åº¦ä¼°ç®—æ–‡ä»¶ï¼ˆ.txtï¼‰**ï¼š
   - åŒ…å«æ¯ä¸ªåŸºå› ç»„åˆ†ç®±åœ¨æ ·æœ¬ä¸­çš„ä¸°åº¦ä¼°ç®—ã€‚
   ```plaintext
   Bin ID    Abundance
   bin1      0.25
   bin2      0.30
   ```

5. **è¦†ç›–ç‡æ–‡ä»¶ï¼ˆ.txtï¼‰**ï¼š
   - åŒ…å«æ¯ä¸ªåŸºå› ç»„åˆ†ç®±çš„è¦†ç›–ç‡ä¿¡æ¯ã€‚
   ```plaintext
   Bin ID    Coverage
   bin1      30x
   bin2      25x
   ```

6. **æ ¸è‹·é…¸ç»„æˆæ–‡ä»¶ï¼ˆ.txtï¼‰**ï¼š
   - åŒ…å«æ¯ä¸ªåŸºå› ç»„åˆ†ç®±çš„æ ¸è‹·é…¸ç»„æˆä¿¡æ¯ã€‚
   ```plaintext
   Bin ID    GC Content
   bin1      45%
   bin2      50%
   ```

7. **é¢„æµ‹åŸºå› åºåˆ—æ–‡ä»¶ï¼ˆ.faaï¼‰**ï¼š
   - åŒ…å«æ¯ä¸ªåŸºå› ç»„åˆ†ç®±çš„é¢„æµ‹è›‹ç™½è´¨åºåˆ—ã€‚
   ```plaintext
   >bin1_gene1
   MKTIIALSYIFCLVFA
   >bin1_gene2
   MKSVIIFLCLCVFA
   ```
è¿™äº›è¾“å‡ºæ–‡ä»¶å¯ä»¥è¿›ä¸€æ­¥åˆ†æå¹¶ç”¨äºä¸‹æ¸¸åº”ç”¨ï¼Œä¾‹å¦‚åŠŸèƒ½æ³¨é‡Šã€æ¯”è¾ƒåŸºå› ç»„å­¦å’Œç³»ç»Ÿå‘è‚²åˆ†æã€‚

binningæ•´ä½“æµç¨‹è¿˜æ˜¯æ¯”è¾ƒæ…¢çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸‹è½½å·²ç»è·‘å¥½çš„ç»“æœï¼ˆä¸‹é¢é“¾æ¥ï¼‰çœ‹çœ‹å»åšåç»­åˆ†æï¼š

```bash
https://zenodo.org/api/records/7845138/files-archive
```

é‡Œé¢åŒ…å«äº†6ä¸ªæ ·æœ¬å•æ ·æœ¬binningçš„ç»“æœï¼Œæ¯ä¸ªæ ·æœ¬å„3ï½8ä¸ªbinsã€‚

### Checking quality

åœ¨å®åŸºå› ç»„åˆ†ç®±å®Œæˆåï¼Œè¯„ä¼°å…¶è´¨é‡éå¸¸é‡è¦ã€‚CheckM (Parks et al. 2015) æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„è¯„ä¼°åˆ†ç®±è´¨é‡çš„å·¥å…·ã€‚CheckM ä½¿ç”¨ä¸€ç»„åœ¨å‡ ä¹æ‰€æœ‰ç»†èŒå’Œå¤èŒåŸºå› ç»„ä¸­å­˜åœ¨çš„é€šç”¨å•æ‹·è´æ ‡è®°åŸºå› æ¥è¯„ä¼°åŸºå› ç»„åˆ†ç®±çš„å®Œæ•´æ€§å’Œæ±¡æŸ“åº¦ã€‚

- CheckM çš„å…³é”®åŠŸèƒ½

1. **åŸºå› ç»„å®Œæ•´æ€§ä¼°è®¡**ï¼š
   - CheckM ä½¿ç”¨ä¸€ç»„é€šç”¨å•æ‹·è´æ ‡è®°åŸºå› æ¥ä¼°è®¡åŸºå› ç»„åˆ†ç®±çš„å®Œæ•´æ€§ã€‚å®Œæ•´æ€§å¾—åˆ†è¡¨ç¤ºè¿™äº›æ ‡è®°åŸºå› ä¸­æœ‰å¤šå°‘æ¯”ä¾‹å­˜åœ¨äºåˆ†ç®±ä¸­ï¼Œä»è€Œæä¾›äº†å›æ”¶åŸºå› ç»„çš„ç¨‹åº¦ä¼°è®¡ã€‚
2. **åŸºå› ç»„æ±¡æŸ“åº¦ä¼°è®¡**ï¼š
   - CheckM ä¹Ÿä½¿ç”¨åŒä¸€ç»„æ ‡è®°åŸºå› æ¥ä¼°è®¡åŸºå› ç»„åˆ†ç®±çš„æ±¡æŸ“åº¦ã€‚æ±¡æŸ“åº¦å¾—åˆ†è¡¨ç¤ºåœ¨å¤šä¸ªåˆ†ç®±ä¸­å‘ç°çš„æ ‡è®°åŸºå› çš„æ¯”ä¾‹ï¼Œè¿™è¡¨æ˜è¯¥åŸºå› ç»„åˆ†ç®±å¯èƒ½åŒ…å«æ¥è‡ªå¤šä¸ªç”Ÿç‰©çš„DNAã€‚
3. **æ½œåœ¨é”™è¯¯ç»„è£…çš„è¯†åˆ«**ï¼š
   - CheckM å¯ä»¥æ ¹æ®æ ‡è®°åŸºå› åœ¨åŸºå› ç»„ä¸­çš„åˆ†å¸ƒè¯†åˆ«æ½œåœ¨çš„é”™è¯¯ç»„è£…ã€‚
4. **ç»“æœå¯è§†åŒ–**ï¼š
   - CheckM èƒ½ç”Ÿæˆå„ç§å›¾è¡¨å’Œè¡¨æ ¼æ¥å¯è§†åŒ–åŸºå› ç»„åˆ†ç®±çš„å®Œæ•´æ€§ã€æ±¡æŸ“åº¦å’Œå…¶ä»–è´¨é‡æŒ‡æ ‡ï¼Œä½¿å¾—ç»“æœæ›´æ˜“äºè§£é‡Šã€‚
5. **åˆ†ç±»å­¦åˆ†ç±»**ï¼š
   - CheckM ä¹Ÿå¯ä»¥åŸºäºç‰¹å®šæ ‡è®°åŸºå› çš„å­˜åœ¨å¯¹åŸºå› ç»„åˆ†ç®±è¿›è¡Œåˆ†ç±»ï¼Œæä¾›ä»åŸŸåˆ°ç§çš„ä¸åŒåˆ†ç±»æ°´å¹³çš„ä¿¡æ¯ã€‚

- ä½¿ç”¨ CheckM è¿›è¡Œè¯„ä¼°

ä»¥ä¸‹æ˜¯ä½¿ç”¨ CheckM çš„ä¸€ä¸ªç¤ºä¾‹å·¥ä½œæµç¨‹ï¼Œä¸»è¦ä½¿ç”¨ `lineage_wf` å·¥ä½œæµç¨‹æ¥è¯„ä¼°åŸºå› ç»„åˆ†ç®±çš„å®Œæ•´æ€§å’Œæ±¡æŸ“åº¦ï¼Œå¹¶è¿›è¡Œåˆ†ç±»å­¦åˆ†ç±»ï¼š

1. **å‡†å¤‡è¾“å…¥æ•°æ®**ï¼š
   å°†ä½ çš„åˆ†ç®±ç»“æœï¼ˆé€šå¸¸æ˜¯FASTAæ–‡ä»¶æ ¼å¼ï¼‰å‡†å¤‡å¥½ã€‚
   ```bash
   mkdir bins
   mv bin*.fa bins/
   ```
2. **è¿è¡Œ CheckM lineage_wf**ï¼š
   ä½¿ç”¨ `lineage_wf` å·¥ä½œæµç¨‹æ¥è¯„ä¼°åŸºå› ç»„åˆ†ç®±ã€‚
   ```bash
   checkm lineage_wf -x fa bins/ checkm_output/ -t 4
   ```
   å‚æ•°è§£é‡Šï¼š
   - `-x fa` æŒ‡å®šæ–‡ä»¶æ‰©å±•åä¸º `.fa`ã€‚
   - `bins/` æ˜¯è¾“å…¥åˆ†ç®±æ–‡ä»¶çš„ç›®å½•ã€‚
   - `checkm_output/` æ˜¯è¾“å‡ºç»“æœçš„ç›®å½•ã€‚
   - `-t 4` æŒ‡å®šä½¿ç”¨ 4 ä¸ªçº¿ç¨‹ã€‚
   
   Lineage_wf(æ›´å‡†ç¡®)ï¼Œtaxonomy_wf(æ›´å¿«)ã€‚
3. **æŸ¥çœ‹ç»“æœ**ï¼š
   è¿è¡Œå®Œæˆåï¼Œç»“æœä¼šä¿å­˜åœ¨ `checkm_output` ç›®å½•ä¸­ã€‚ä½ å¯ä»¥æŸ¥çœ‹ä¸»è¦çš„ç»“æœæ–‡ä»¶ `bins_stats` ä»¥è·å¾—æ¯ä¸ªåˆ†ç®±çš„å®Œæ•´æ€§å’Œæ±¡æŸ“åº¦ç­‰ä¿¡æ¯ã€‚

â€œCheckM lineage_wfâ€çš„è¾“å‡ºåŒ…æ‹¬å¤šä¸ªæ–‡ä»¶å’Œè¡¨æ ¼ï¼Œæä¾›äº†æœ‰å…³åŸºå› ç»„åˆ†ç®±çš„åˆ†ç±»å’Œè´¨é‡è¯„ä¼°çš„ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å…³é”®çš„è¾“å‡ºå†…å®¹ï¼š

1. **è¾“å‡ºæŠ¥å‘Šï¼ˆCheckM Lineage Workflow Output Reportï¼‰**ï¼š
   - è¯¥æŠ¥å‘Šæä¾›äº† CheckM è¿›è¡Œçš„è´¨é‡è¯„ä¼°çš„æ€»ç»“ã€‚åŒ…æ‹¬åˆ†æçš„åŸºå› ç»„æ•°é‡ã€å®ƒä»¬çš„å®Œæ•´æ€§ã€æ±¡æŸ“åº¦åŠå…¶ä»–è´¨é‡æŒ‡æ ‡ã€‚
2. **ç‰¹å®šè°±ç³»çš„è´¨é‡è¯„ä¼°ï¼ˆLineage-specific Quality Assessmentï¼‰**ï¼š
   - CheckM ä¸ºæ¯ä¸ªåˆ†æçš„åŸºå› ç»„ç”Ÿæˆç‰¹å®šè°±ç³»çš„è´¨é‡è¯„ä¼°æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶åŒ…å«åŸºäºåˆ†ç±»è°±ç³»çš„åŸºå› ç»„å®Œæ•´æ€§å’Œæ±¡æŸ“åº¦çš„è¯¦ç»†ä¿¡æ¯ã€‚
3. **æ ‡è®°é›†åˆ†æï¼ˆMarker Set Analysisï¼‰**ï¼š
   - CheckM ä½¿ç”¨ä¸€ç»„æ ‡è®°åŸºå› æ¥ä¼°è®¡åŸºå› ç»„çš„å®Œæ•´æ€§å’Œæ±¡æŸ“åº¦ã€‚å·¥å…·ç”Ÿæˆæ ‡è®°ç‰¹å®šåˆ†ææ–‡ä»¶ï¼Œæä¾›åˆ†æåŸºå› ç»„ä¸­æ¯ä¸ªæ ‡è®°åŸºå› çš„å­˜åœ¨ã€ç¼ºå¤±å’Œæ‹·è´æ•°çš„è¯¦ç»†ä¿¡æ¯ã€‚
4. **å¯è§†åŒ–ï¼ˆVisualizationsï¼‰**ï¼š
   - CheckM ç”Ÿæˆå„ç§å¯è§†åŒ–å›¾è¡¨ï¼Œä»¥å¸®åŠ©è§£é‡Šç»“æœã€‚è¿™äº›å›¾åŒ…æ‹¬è°±ç³»ç‰¹å®šçš„å®Œæ•´æ€§å’Œæ±¡æŸ“åº¦å›¾ã€æ•£ç‚¹å›¾åŠå…¶ä»–æ•°æ®çš„å¯è§†åŒ–è¡¨ç¤ºã€‚
5. **è¡¨æ ¼å’Œæ•°æ®æ–‡ä»¶ï¼ˆTables and Data Filesï¼‰**ï¼š
   - CheckM ç”ŸæˆåŒ…å«åˆ†æåŸºå› ç»„è¯¦ç»†ä¿¡æ¯çš„è¡¨æ ¼æ•°æ®æ–‡ä»¶ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„åç§°ã€åˆ†ç±»åˆ†é…ã€å®Œæ•´æ€§è¯„åˆ†ã€æ±¡æŸ“åº¦è¯„åˆ†å’Œå…¶ä»–ç›¸å…³æŒ‡æ ‡ã€‚è¿™äº›æ–‡ä»¶å¯¹äºè¿›ä¸€æ­¥çš„ä¸‹æ¸¸åˆ†ææˆ–æ•°æ®å¤„ç†éå¸¸æœ‰ç”¨ã€‚

- ç¤ºä¾‹è¾“å‡ºæ–‡ä»¶å’Œè§£é‡Š

1. **è¾“å‡ºæŠ¥å‘Šæ–‡ä»¶**ï¼š
   - `checkm_output/storage/bin_stats_ext.tsv`ï¼šåŒ…å«æ¯ä¸ªåˆ†ç®±çš„è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯ï¼Œå¦‚å®Œæ•´æ€§ã€æ±¡æŸ“åº¦ã€æ ‡è®°åŸºå› æ•°ç›®ç­‰ï¼Œè‡ªè¡Œæ•´ç†ä¸ºè¡¨æ ¼ï¼š
   ```plaintext
   Bin Id  Completeness  Contamination  Strain heterogeneity
   bin1    98.5          1.2            0.0
   bin2    85.4          4.7            0.5
   ```
2. **è°±ç³»ç‰¹å®šè´¨é‡è¯„ä¼°æ–‡ä»¶**ï¼š
   - `checkm_output/lineage.ms`ï¼šåŒ…å«æ¯ä¸ªåŸºå› ç»„åˆ†ç®±çš„è°±ç³»ç‰¹å®šè´¨é‡è¯„ä¼°ä¿¡æ¯ï¼Œè‡ªè¡Œæ•´ç†ä¸ºè¡¨æ ¼ï¼š
   ```plaintext
   bin1    Bacteria;Proteobacteria;Gammaproteobacteria   98.5   1.2
   bin2    Bacteria;Firmicutes;Bacilli                  85.4   4.7
   ```
3. **æ ‡è®°åŸºå› åˆ†ææ–‡ä»¶**ï¼š
   - `checkm_output/marker_gene_stats.tsv`ï¼šæä¾›åˆ†æåŸºå› ç»„ä¸­æ¯ä¸ªæ ‡è®°åŸºå› çš„å­˜åœ¨ã€ç¼ºå¤±å’Œæ‹·è´æ•°çš„è¯¦ç»†ä¿¡æ¯ï¼Œè‡ªè¡Œæ•´ç†ä¸ºè¡¨æ ¼ï¼š
   ```plaintext
   Bin Id  Marker gene   Presence  Copy number
   bin1    rplA          Present   1
   bin1    rplB          Present   1
   bin2    rplA          Present   2
   bin2    rplB          Absent    0
   ```
4. **å¯è§†åŒ–æ–‡ä»¶**ï¼š
   - `checkm_output/plots/` ç›®å½•åŒ…å«å„ç§å›¾è¡¨ï¼Œå¦‚å®Œæ•´æ€§å’Œæ±¡æŸ“åº¦çš„æ•£ç‚¹å›¾ã€è°±ç³»ç‰¹å®šçš„å®Œæ•´æ€§å’Œæ±¡æŸ“åº¦å›¾ç­‰ã€‚


### De-replication

å»å†—ä½™ï¼ˆDe-replicationï¼‰æ˜¯è¯†åˆ«åŸºå› ç»„åˆ—è¡¨ä¸­â€œç›¸åŒâ€åŸºå› ç»„é›†åˆçš„è¿‡ç¨‹ï¼Œå¹¶ä»æ¯ä¸ªå†—ä½™é›†åˆä¸­å»é™¤é™¤â€œæœ€ä½³â€åŸºå› ç»„ä¹‹å¤–çš„æ‰€æœ‰å…¶ä»–åŸºå› ç»„ã€‚åŸºå› ç»„éœ€è¦å¤šç›¸ä¼¼æ‰è¢«è®¤ä¸ºæ˜¯â€œç›¸åŒçš„â€ã€å¦‚ä½•ç¡®å®šå“ªä¸ªåŸºå› ç»„æ˜¯â€œæœ€ä½³çš„â€ä»¥åŠå…¶ä»–é‡è¦å†³ç­–å°†åœ¨é‡è¦æ¦‚å¿µä¸­è®¨è®ºã€‚

å»å†—ä½™çš„ä¸€ä¸ªå¸¸è§ç”¨é€”æ˜¯é’ˆå¯¹ä¸ªåˆ«å®åŸºå› ç»„æ•°æ®çš„ç»„è£…ã€‚å¦‚æœå®åŸºå› ç»„æ ·æœ¬æ˜¯æŒ‰ç³»åˆ—æ”¶é›†çš„ï¼Œä¸€ç§å¸¸è§çš„ç»„è£…çŸ­è¯»æ®µçš„æ–¹æ³•æ˜¯â€œå…±ç»„è£…â€ã€‚å³å°†æ‰€æœ‰æ ·æœ¬çš„è¯»æ®µç»“åˆåœ¨ä¸€èµ·è¿›è¡Œç»„è£…ã€‚ç„¶è€Œï¼Œè¿™æ ·åšçš„é—®é¢˜æ˜¯ï¼Œç›¸ä¼¼èŒæ ªçš„ç»„è£…ä¼šä¸¥é‡å¯¼è‡´ç»„è£…çš„ç‰‡æ®µåŒ–ï¼Œå¦¨ç¢è·å¾—ä¸€ä¸ªå¥½çš„åŸºå› ç»„åˆ†ç®±ã€‚

ä¸€ç§æ›¿ä»£æ–¹æ¡ˆæ˜¯åˆ†åˆ«ç»„è£…æ¯ä¸ªæ ·æœ¬ï¼Œç„¶åå¯¹æ¯ä¸ªç»„è£…ç»“æœä¸­çš„åˆ†ç®±è¿›è¡Œå»å†—ä½™ï¼Œä»¥ç”Ÿæˆæœ€ç»ˆçš„åŸºå› ç»„é›†åˆã€‚

![](images/individual-assembly.png)

MetaBAT 2 å¹¶ä¸ä¼šæ˜ç¡®åœ°æ‰§è¡Œå»å†—ä½™è¿‡ç¨‹ï¼Œå³åœ¨ç»™å®šçš„æ•°æ®é›†ä¸­è¯†åˆ«ç›¸åŒæˆ–é«˜åº¦ç›¸ä¼¼çš„åŸºå› ç»„ç»„ã€‚ç›¸åï¼ŒMetaBAT 2 ä¸»è¦é€šè¿‡åˆ©ç”¨è¯»æ®µè¦†ç›–ç‡ã€æ ·æœ¬é—´çš„å·®å¼‚è¦†ç›–ç‡å’Œåºåˆ—ç»„æˆç­‰ç‰¹å¾æ¥æé«˜åˆ†ç®±çš„å‡†ç¡®æ€§ã€‚å®ƒçš„ç›®æ ‡æ˜¯åŒºåˆ†å®åŸºå› ç»„æ•°æ®é›†ä¸­ä¸åŒçš„åŸºå› ç»„ï¼Œå¹¶å°†contigsåˆ†é…åˆ°é€‚å½“çš„åˆ†ç®±ä¸­ã€‚

dRep æ˜¯ä¸€ä¸ªä¸“é—¨è®¾è®¡ç”¨äºå®åŸºå› ç»„æ•°æ®é›†ä¸­åŸºå› ç»„å»å†—ä½™çš„è½¯ä»¶å·¥å…·ã€‚å…¶ç›®æ ‡æ˜¯ä¿ç•™ä¸€ä¸ªä»£è¡¨æ€§åŸºå› ç»„é›†ï¼Œä»¥æ”¹å–„åç»­çš„åˆ†æï¼Œå¦‚åˆ†ç±»å­¦åˆ†æå’ŒåŠŸèƒ½æ³¨é‡Šã€‚

- dRep çš„å…¸å‹å·¥ä½œæµç¨‹

1. **åŸºå› ç»„è´¨é‡è¯„ä¼°**ï¼š
   - dRep ä¼šè¿è¡ŒcheckMè¯„ä¼°æ¯ä¸ªç°‡å†…åŸºå› ç»„çš„è´¨é‡ï¼Œè€ƒè™‘å› ç´ åŒ…æ‹¬å®Œæ•´æ€§ã€æ±¡æŸ“åº¦å’ŒèŒæ ªå¼‚è´¨æ€§ã€‚
2. **åŸºå› ç»„æ¯”è¾ƒ**ï¼š
   - dRep ä½¿ç”¨æˆå¯¹åŸºå› ç»„æ¯”è¾ƒæ–¹æ³•æ¥è¯„ä¼°ç»™å®šå®åŸºå› ç»„æ•°æ®é›†ä¸­åŸºå› ç»„ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚
3. **èšç±»**ï¼š
   - æ ¹æ®åŸºå› ç»„ç›¸ä¼¼æ€§ï¼ŒdRep æ‰§è¡Œèšç±»ï¼Œå°†ç›¸ä¼¼åŸºå› ç»„åˆ†ç»„ä¸ºâ€œåŸºå› ç»„ç°‡â€ã€‚æ¯ä¸ªç°‡ä»£è¡¨ä¸€ç»„å¯†åˆ‡ç›¸å…³çš„åŸºå› ç»„ã€‚
4. **åŸºå› ç»„é€‰æ‹©**ï¼š
   - åœ¨æ¯ä¸ªåŸºå› ç»„ç°‡å†…ï¼ŒdRep æ ¹æ®ç”¨æˆ·å®šä¹‰çš„æ ‡å‡†é€‰æ‹©ä¸€ä¸ªä»£è¡¨æ€§åŸºå› ç»„ã€‚è¿™ä¸ªä»£è¡¨æ€§åŸºå› ç»„è¢«è§†ä¸ºç°‡çš„â€œå»å†—ä½™â€ç‰ˆæœ¬ã€‚
5. **å»å†—ä½™è¾“å‡º**ï¼š
   - dRep çš„è¾“å‡ºåŒ…æ‹¬å»å†—ä½™åŸºå› ç»„çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„èº«ä»½ã€å®Œæ•´æ€§å’Œæ±¡æŸ“åº¦ã€‚ç”¨æˆ·å¯ä»¥é€‰æ‹©ä¸€ä¸ªåŸºå› ç»„ç›¸ä¼¼æ€§é˜ˆå€¼æ¥æ§åˆ¶å»å†—ä½™çš„æ°´å¹³ã€‚

- dRep çš„ä½¿ç”¨ç¤ºä¾‹

1. **å‡†å¤‡è¾“å…¥æ–‡ä»¶**ï¼š
   - å°†æ‰€æœ‰è¦å»å†—ä½™çš„åŸºå› ç»„æ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªç›®å½•ä¸­ã€‚
   ```bash
   mkdir genomes
   mv genome1.fasta genome2.fasta ... genomes/
   ```
2. **è¿è¡ŒdRep**ï¼š
   - ä½¿ç”¨ dRep å¯¹åŸºå› ç»„è¿›è¡Œå»å†—ä½™ã€‚ä»¥ä¸‹å‘½ä»¤ä¼šåœ¨æŒ‡å®šçš„è¾“å‡ºç›®å½•ä¸­æ‰§è¡Œå»å†—ä½™åˆ†æã€‚
   - **ç›¸ä¼¼æ€§é˜ˆå€¼**ï¼šå¯ä»¥é€šè¿‡ `--S_algorithm` å’Œ `--S_ani` å‚æ•°è®¾ç½®ç”¨äºåŸºå› ç»„èšç±»çš„ç›¸ä¼¼æ€§è®¡ç®—æ–¹æ³•å’Œé˜ˆå€¼ã€‚
   - **è´¨é‡æ ‡å‡†**ï¼šå¯ä»¥é€šè¿‡ `--completeness`ã€`--contamination` ç­‰å‚æ•°è®¾ç½®é€‰æ‹©ä»£è¡¨æ€§åŸºå› ç»„çš„è´¨é‡æ ‡å‡†ã€‚
   ```bash
   dRep dereplicate output_directory -g genomes/*.fasta
   ```
   - å¦‚æœä½ å·²ç»è‡ªå·±è¿è¡Œäº†checkMï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ checkM çš„è¾“å‡ºæ–‡ä»¶æŒ‡å®šç»™ `--genomeInfo`ï¼ˆæ¯•ç«ŸcheckMä¹Ÿè¦å¾ˆä¹…ï¼‰ã€‚
   - è‡ªå·±æ•´ç†bin_info.csvæ–‡ä»¶ï¼Œ3åˆ—ï¼Œåˆ†åˆ«ä¸ºgenome nameï¼Œcompletenessï¼Œcontaminationã€‚
   ```bash
   dRep dereplicate output_directory -g genomes/*.fasta --genomeInfo checkm_output/storage/bin_info.csv
   ```   
   - å¦‚æœä½ è‡ªè¡Œç­›é€‰äº†binsï¼Œä¹Ÿå°±æ˜¯è¯´ä½ è®¤ä¸ºè¾“å…¥çš„éƒ½æ˜¯åˆæ ¼binsï¼Œå¯ä»¥ç”¨`--ignoreGenomeQuality` å¿½ç•¥è´¨é‡è¯„ä¼°ã€‚
   ```bash
   dRep dereplicate output_directory -g genomes/*.fasta --ignoreGenomeQuality
   ```
   
3. **è¾“å‡ºè§£é‡Š**ï¼š
   - è¾“å‡ºç›®å½•ä¸­å°†åŒ…å«å¤šä¸ªæ–‡ä»¶å’Œå­ç›®å½•ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š
     - **dereplicated_genomes**ï¼šå»å†—ä½™åçš„åŸºå› ç»„æ–‡ä»¶ã€‚
     - **cluster_reports**ï¼šåŒ…å«æ¯ä¸ªåŸºå› ç»„ç°‡çš„ä¿¡æ¯ã€‚
     - **quality_reports**ï¼šè¯„ä¼°åŸºå› ç»„è´¨é‡çš„æŠ¥å‘Šã€‚


**è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ä½¿ç”¨Metabat2è¿›è¡ŒåŸºå› ç»„åˆ†ç®±ï¼Œä½¿ç”¨checkMè¯„ä¼°binsä»¥åŠä½¿ç”¨dRepè¿›è¡Œbinså»å†—ä½™å¾—åˆ°æœ€ç»ˆçš„åˆæ ¼binsï¼Œè¿™äº›æ˜¯å®åŸºå› ç»„binningåˆ†æçš„æ ¸å¿ƒæ­¥éª¤ã€‚**

åç»­å¯ä»¥å¯¹å¾—åˆ°çš„MAGsè¿›è¡Œç‰©ç§æ³¨é‡Šï¼ˆæ¯”å¦‚ç”¨[GTDB-tk](https://asa-blog.netlify.app/p/gtdb)ï¼‰ï¼ŒåŠŸèƒ½æ³¨é‡Šï¼ˆæ¯”å¦‚[antismashåˆ†æBGCs](https://asa-blog.netlify.app/p/antismash)ï¼‰ï¼Œä»¥åŠå¾ˆå¤šåŸºå› ç»„çº§åˆ«çš„æ·±å…¥åˆ†æã€‚

## References

1.  Alneberg, J., B. S. Bjarnason, I. de Bruijn, M. Schirmer, J. Quick *et al.*, 2014 **Binning metagenomic contigs by coverage and composition**. Nature Methods 11: 1144â€“1146. <https://doi.org/10.1038/nmeth.3103>
2.  Imelfort, M., D. Parks, B. J. Woodcroft, P. Dennis, P. Hugenholtz *et al.*, 2014 **GroopM: an automated tool for the recovery of population genomes from related metagenomes**. PeerJ 2: e603. <https://doi.org/10.7717/peerj.603>
3.  Eren, A. M., Ã–zcan C. Esen, C. Quince, J. H. Vineis, H. G. Morrison *et al.*, 2015 **Anviâ€™o: an advanced analysis and visualization platform for â€˜omics data**. PeerJ 3: e1319. <https://doi.org/10.7717/peerj.1319>
4.  Parks, D. H., M. Imelfort, C. T. Skennerton, P. Hugenholtz, and G. W. Tyson, 2015 **CheckM: assessing the quality of microbial genomes recovered from isolates, single cells, and metagenomes**. Genome Research 25: 1043â€“1055. <https://doi.org/10.1101/gr.186072.114>
5.  Wu, Y.-W., B. A. Simmons, and S. W. Singer, 2015 **MaxBin 2.0: an automated binning algorithm to recover genomes from multiple metagenomic datasets**. Bioinformatics 32: 605â€“607. <https://doi.org/10.1093/bioinformatics/btv638>
6.  Lin, H.-H., and Y.-C. Liao, 2016 **Accurate binning of metagenomic contigs via automated clustering sequences using information of genomic signatures and marker genes**. Scientific Reports 6: <https://doi.org/10.1038/srep24175>
7.  Sczyrba, A., P. Hofmann, P. Belmann, D. Koslicki, S. Janssen *et al.*, 2017 **Critical Assessment of Metagenome Interpretationâ€”a benchmark of metagenomics software**. Nature Methods 14: 1063â€“1071. <https://doi.org/10.1038/nmeth.4458>
8.  Uritskiy, G. V., J. DiRuggiero, and J. Taylor, 2018 **MetaWRAPâ€”a flexible pipeline for genome-resolved metagenomic data analysis**. Microbiome 6: <https://doi.org/10.1186/s40168-018-0541-1>
9.  Kang, D. D., F. Li, E. Kirton, A. Thomas, R. Egan *et al.*, 2019 **Metabat2: an adaptive binning algorithm for robust and efficient genome reconstruction from metagenome assemblies**. PeerJ 7: e7359. <https://doi.org/10.7717/peerj.7359>
10. Evans, J. T., and V. J. Denef, 2020 **To Dereplicate or Not To Dereplicate?** mSphere 5: e00971â€“19. Publisher: American Society for Microbiology. <https://doi.org/10.1128/mSphere.00971-19>
11. Pan, S., C. Zhu, X.-M. Zhao, and L. P. Coelho, 2022 **A deep siamese neural network improves metagenome-assembled genomes in microbiome datasets across different environments**. Nature Communications 13: <https://doi.org/10.1038/s41467-022-29843-y>
