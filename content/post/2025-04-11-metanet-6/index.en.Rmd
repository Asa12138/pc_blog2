---
title: MetaNetï¼šå¤šç»„å­¦ç½‘ç»œåˆ†æå·¥å…·ï½œ6.ç½‘ç»œæ‹“æ‰‘æŒ‡æ ‡åˆ†æ
author: Peng Chen
date: '2025-04-14'
slug: metanet-6
categories:
  - R
tags:
  - network
  - R
description: ç½‘ç»œæ‹“æ‰‘ï¼ˆNetwork Topologyï¼‰æ˜¯æŒ‡ç½‘ç»œä¸­èŠ‚ç‚¹ä¸è¾¹çš„è¿æ¥æ¨¡å¼æ‰€å‘ˆç°çš„å…¨å±€æˆ–å±€éƒ¨ç»“æ„ç‰¹å¾ã€‚
image: images/node_topo.png
math: ~
license: ~
hidden: no
comments: yes
---

```{r include=FALSE}
devtools::load_all("~/Documents/R/pcutils/")
devtools::load_all("~/Documents/R/MetaNet/MetaNet/")
data(otutab, package = "pcutils")
Packages <- c("dplyr", "pcutils", "kableExtra")
pcutils::lib_ps(Packages)
knitr::opts_chunk$set(message = FALSE,warning = FALSE,cache = T,fig.width=8,fig.height=5)
```

æœ¬æ–‡æˆ‘ä»¬ä»‹ç»ç½‘ç»œçš„å„ç§æ‹“æ‰‘æŒ‡æ ‡è®¡ç®—å’Œåˆ†æã€‚ç½‘ç»œæ‹“æ‰‘ï¼ˆNetwork Topologyï¼‰æ˜¯æŒ‡ç½‘ç»œä¸­èŠ‚ç‚¹ä¸è¾¹çš„è¿æ¥æ¨¡å¼æ‰€å‘ˆç°çš„å…¨å±€æˆ–å±€éƒ¨ç»“æ„ç‰¹å¾ã€‚åœ¨ç”Ÿç‰©ç»„å­¦ç ”ç©¶ä¸­ï¼Œæ‹“æ‰‘åˆ†æèƒ½æ­ç¤ºåˆ†å­äº’ä½œç½‘ç»œçš„åŠŸèƒ½ç»„ç»‡è§„å¾‹ï¼Œæ˜¯ç†è§£å¤æ‚ç”Ÿç‰©ç³»ç»Ÿçš„å…³é”®æ‰‹æ®µã€‚

- è½¯ä»¶ä¸»é¡µï¼š<https://github.com/Asa12138/MetaNet> **å¤§å®¶å¯ä»¥å¸®å¿™åœ¨githubä¸Šç‚¹ç‚¹starâ­ï¸**ï¼Œè°¢è°¢ğŸ™
- è¯¦ç»†è‹±æ–‡ç‰ˆæ•™ç¨‹ï¼š<https://bookdown.org/Asa12138/metanet_book/>

å¯ä»¥ä» CRAN å®‰è£…ç¨³å®šç‰ˆï¼š`install.packages("MetaNet")`  

ä¾èµ–åŒ… `pcutils`å’Œ`igraph`ï¼ˆéœ€æå‰å®‰è£…ï¼‰ï¼Œæ¨èé…åˆ `dplyr` è¿›è¡Œæ•°æ®æ“ä½œã€‚

```r
library(MetaNet)
library(igraph)

# ========data manipulation
library(dplyr)
library(pcutils)
```

## æ‹“æ‰‘æŒ‡æ ‡

å…¨å±€æ‹“æ‰‘ï¼ˆGlobal Topologyï¼‰æè¿°ç½‘ç»œæ•´ä½“è¿æ¥ç‰¹æ€§ï¼Œå±€éƒ¨æ‹“æ‰‘ï¼ˆLocal Topologyï¼‰èšç„¦å•ä¸ªèŠ‚ç‚¹/è¾¹çš„ç»“æ„é‡è¦æ€§ï¼ŒMetaNetå¯ä»¥å¯¹æ„å»ºå¥½çš„ç½‘ç»œè¿›è¡Œå¤šç§æ‹“æ‰‘æŒ‡æ ‡çš„è®¡ç®—å’Œåˆ†æã€‚

### å±€éƒ¨æ‹“æ‰‘æŒ‡æ ‡

![](images/node_topo.png)

1. **Connectivity/Degree centrality**  
   è¡¡é‡èŠ‚ç‚¹ç›´æ¥è¿æ¥æ•°é‡çš„åŸºç¡€æŒ‡æ ‡ï¼Œåæ˜ èŠ‚ç‚¹çš„å±€éƒ¨å½±å“åŠ›ã€‚

2. **Betweenness centrality**  
   ç»Ÿè®¡èŠ‚ç‚¹å‡ºç°åœ¨æ‰€æœ‰æœ€çŸ­è·¯å¾„ä¸­çš„é¢‘ç‡ï¼Œè¯†åˆ«ç½‘ç»œä¸­çš„"æ¡¥æ¢"èŠ‚ç‚¹ã€‚

3. **Closeness centrality**  
   è®¡ç®—èŠ‚ç‚¹åˆ°å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹çš„å¹³å‡æœ€çŸ­è·ç¦»å€’æ•°ï¼Œä½“ç°ä¿¡æ¯ä¼ æ’­æ•ˆç‡ã€‚

4. **Eigenvector centrality**  
   è€ƒè™‘é‚»å±…èŠ‚ç‚¹çš„é‡è¦æ€§åŠ æƒè®¡ç®—ï¼Œé€‚ç”¨äºè¯„ä¼°ä¾èµ–é«˜ç«¯è¿æ¥çš„èŠ‚ç‚¹å½±å“åŠ›ã€‚

5. **Clustering coefficient**  
   é‡åŒ–èŠ‚ç‚¹é‚»å±…é—´çš„è¿æ¥ç´§å¯†ç¨‹åº¦ï¼Œæ­ç¤ºç½‘ç»œå±€éƒ¨æ¨¡å—åŒ–ç‰¹æ€§ã€‚

6. **Eccentricity**  
   å®šä¹‰èŠ‚ç‚¹åˆ°ç½‘ç»œä¸­æœ€è¿œèŠ‚ç‚¹çš„è·ç¦»ï¼Œåæ˜ èŠ‚ç‚¹çš„å…¨å±€ä½ç½®ç‰¹å¾ã€‚

7. **PageRank**  
   åŸºäºéšæœºæ¸¸èµ°æ¨¡å‹è¿­ä»£è®¡ç®—çš„èŠ‚ç‚¹é‡è¦æ€§ï¼Œé€‚ç”¨äºæœ‰å‘ç½‘ç»œï¼ˆå¦‚åŸºå› è°ƒæ§ç½‘ç»œï¼‰ã€‚

8. **Kleinberg's hub/authority centrality**  
   åŒå‘è¯„ä»·èŠ‚ç‚¹ä»·å€¼ï¼šhubï¼ˆæŒ‡å‘é‡è¦èŠ‚ç‚¹ï¼‰å’Œauthorityï¼ˆè¢«é‡è¦èŠ‚ç‚¹æŒ‡å‘ï¼‰ã€‚

æ›´ç»†è‡´çš„ä»‹ç»å¯ä»¥çœ‹ä¸‹è¡¨ï¼Œæ¥è‡ªMetaNetæ•™ç¨‹ç½‘é¡µï¼š

![](images/node_topodf.png)

### å…¨å±€æ‹“æ‰‘æŒ‡æ ‡

1. **Average connectivity/degree**  
   ç½‘ç»œä¸­æ‰€æœ‰èŠ‚ç‚¹è¿æ¥æ•°çš„å¹³å‡å€¼ï¼Œåæ˜ æ•´ä½“è¿æ¥å¯†åº¦ã€‚

2. **Average path length/Average geodesic distance**  
   æ‰€æœ‰èŠ‚ç‚¹å¯¹ä¹‹é—´æœ€çŸ­è·¯å¾„çš„å¹³å‡å€¼ï¼Œè¡¡é‡ç½‘ç»œä¿¡æ¯ä¼ é€’æ•ˆç‡ã€‚

3. **Global efficiency/Geodesic efficiency**  
   èŠ‚ç‚¹é—´æœ€çŸ­è·¯å¾„å€’æ•°å’Œçš„æ ‡å‡†åŒ–å€¼ï¼ˆ0-1ï¼‰ï¼Œå€¼è¶Šé«˜è¡¨ç¤ºä¿¡æ¯æµåŠ¨è¶Šé«˜æ•ˆã€‚

4. **Centralization of degree**  
   èŠ‚ç‚¹åº¦åˆ†å¸ƒçš„é›†ä¸­ç¨‹åº¦ï¼ˆ0-1ï¼‰ï¼Œå€¼è¶Šé«˜è¯´æ˜ç½‘ç»œè¶Šä¾èµ–å°‘æ•°æ¢çº½èŠ‚ç‚¹ã€‚

5. **Centralization of betweenness**  
   èŠ‚ç‚¹ä»‹æ•°ä¸­å¿ƒæ€§çš„æ–¹å·®ï¼Œåæ˜ ç½‘ç»œå¯¹"æ¡¥æ¢"èŠ‚ç‚¹çš„ä¾èµ–ç¨‹åº¦ã€‚

6. **Centralization of closeness**  
   æ¥è¿‘ä¸­å¿ƒæ€§çš„åˆ†å¸ƒåæ€ï¼Œè¡¨å¾ç½‘ç»œæ ¸å¿ƒ-è¾¹ç¼˜ç»“æ„çš„å¼ºåº¦ã€‚

7. **Centralization of eigenvector centrality**  
   ç‰¹å¾å‘é‡ä¸­å¿ƒæ€§çš„å¼‚è´¨æ€§ï¼Œè¯„ä¼°é«˜ç«¯è¿æ¥èŠ‚ç‚¹çš„æ”¯é…æ€§ã€‚

8. **Density**  
   å®é™…è¾¹æ•°ä¸æœ€å¤§å¯èƒ½è¾¹æ•°çš„æ¯”å€¼ï¼ˆ0-1ï¼‰ï¼Œæè¿°ç½‘ç»œçš„ç¨€ç–ç¨‹åº¦ã€‚

9. **Average clustering coefficient**  
   æ‰€æœ‰èŠ‚ç‚¹å±€éƒ¨èšç±»ç³»æ•°çš„å‡å€¼ï¼Œé‡åŒ–ç½‘ç»œæ¨¡å—åŒ–è¶‹åŠ¿ã€‚

10. **Transitivity**  
    ä¸‰å…ƒé—­åŒ…æ¯”ä¾‹ï¼ˆä¸‰è§’å½¢ç»“æ„å æ¯”ï¼‰ï¼Œåæ˜ ç½‘ç»œå±€éƒ¨èšé›†ç‰¹æ€§ã€‚

11. **Natural connectivity**  
    åŸºäºç½‘ç»œç‰¹å¾è°±çš„é²æ£’æ€§æŒ‡æ ‡ï¼Œå€¼è¶Šé«˜è¡¨ç¤ºç½‘ç»œè¶Šç¨³å®šã€‚

![](images/net_topodf.png)


**ä¸€äº›æ½œåœ¨çš„ç”Ÿç‰©ç½‘ç»œåˆ†æåº”ç”¨åœºæ™¯ï¼š**

| æŒ‡æ ‡ç±»å‹         | å…¸å‹åº”ç”¨åœºæ™¯                  | è®¡ç®—å¤æ‚åº¦ |
|------------------|-----------------------------|------------|
| Degree           | å¿«é€Ÿç­›é€‰é«˜è¿æ¥åˆ†å­            | O(n)       |
| Betweenness      | å‘ç°è·¨æ¨¡å—è°ƒæ§å› å­            | O(nÂ²)      |
| PageRank         | è¯†åˆ«å…³é”®è°ƒæ§åŸºå›               | O(n log n) |


| æŒ‡æ ‡                          | å…¸å‹ç”Ÿç‰©å­¦æ„ä¹‰                  | ç¤ºä¾‹åœºæ™¯                     |
|-------------------------------|--------------------------------|----------------------------|
| Average path length           | ä»£è°¢ç‰©ä¿¡å·ä¼ å¯¼é€Ÿåº¦             | çŸ­è·¯å¾„=å¿«é€Ÿè°ƒæ§å“åº”         |
| Centralization of degree      | å…³é”®åŸºå› çš„æ”¯é…æ€§               | è½¬å½•å› å­ç½‘ç»œåˆ†æ            |
| Transitivity                  | è›‹ç™½å¤åˆä½“çš„å½¢æˆå€¾å‘           | PPIç½‘ç»œåŠŸèƒ½æ¨¡å—æ£€æµ‹         |
| Natural connectivity          | åŸºå› ç½‘ç»œæŠ—çªå˜èƒ½åŠ›             | ç–¾ç—…ç›¸å…³ç½‘ç»œç¨³å®šæ€§è¯„ä¼°      |


### MetaNetè®¡ç®—

MetaNetæä¾›`net_par()`å‡½æ•°ä¸€é”®è®¡ç®—ç½‘ç»œ/èŠ‚ç‚¹/è¾¹ä¸‰ä¸ªå±‚çº§çš„æ‹“æ‰‘æŒ‡æ ‡ï¼š

```r
library(MetaNet)
library(igraph)

# ç¤ºä¾‹1ï¼šè·å–Waltherç½‘ç»œçš„æ‰€æœ‰æŒ‡æ ‡ï¼ˆè¿”å›åˆ—è¡¨ï¼‰
make_graph("Walther") %>% net_par(mode = "all")

# ç¤ºä¾‹2ï¼šä»…è·å–ç½‘ç»œçº§å…¨å±€æŒ‡æ ‡
make_graph("Walther") %>% net_par(mode = "n")
```

**å‚æ•°è¯´æ˜**ï¼š
- `mode`ï¼šè®¡ç®—èŒƒå›´
  - `"n"`ï¼šç½‘ç»œçº§æŒ‡æ ‡ï¼ˆå¦‚å¯†åº¦ã€å¹³å‡è·¯å¾„é•¿åº¦ï¼‰
  - `"v"`ï¼šèŠ‚ç‚¹çº§æŒ‡æ ‡ï¼ˆå¦‚åº¦ä¸­å¿ƒæ€§ã€ä»‹æ•°ï¼‰
  - `"e"`ï¼šè¾¹çº§æŒ‡æ ‡ï¼ˆå¦‚è¾¹ä»‹æ•°ï¼‰
  - `"all"`ï¼šå…¨éƒ¨æŒ‡æ ‡ï¼ˆè¿”å›åµŒå¥—åˆ—è¡¨ï¼‰

ä¹Ÿå¯ä»¥é€šè¿‡`c_net_index()`è®¡ç®—å¹¶å­˜å‚¨æ‹“æ‰‘æŒ‡æ ‡åˆ°ç½‘ç»œä¸­ï¼Œä¾¿äºåç»­åˆ†æå’Œå¯è§†åŒ–ï¼š

```{r}
# ç”Ÿæˆéšæœºç½‘ç»œ
go <- erdos.renyi.game(30, 0.25) %>% c_net_update()

# è®¡ç®—æ‹“æ‰‘æŒ‡æ ‡å¹¶å­˜å…¥ç½‘ç»œå±æ€§
go <- c_net_index(go)

# æŸ¥çœ‹èŠ‚ç‚¹å±æ€§è¡¨ï¼ˆå‰6è¡Œï¼‰
head(get_v(go))  # åŒ…å«Degreeã€Betweennessç­‰åˆ—
```

å°†èŠ‚ç‚¹åº¦ä¸­å¿ƒæ€§æ˜ å°„ä¸ºå¯è§†åŒ–å±æ€§ï¼š

```{r}
# get a metanet
go <- erdos.renyi.game(30, 0.25)
go <- c_net_update(go)
par(mfrow = c(1, 2))
plot(go, vertex_size_range = c(5, 20), legend = F, main = "Same size")

# calculate topological indexes and store
go <- c_net_index(go)
head(get_v(go))

# use vertex.size to indicate degree
go <- c_net_set(go, vertex_size = "Degree")
plot(go, vertex_size_range = c(5, 20), legend = F, main = "Size map to degree")
```

## éšæœºç½‘ç»œ

éšæœºç½‘ç»œï¼ˆRandom Networkï¼‰æ˜¯ç½‘ç»œç§‘å­¦ä¸­çš„ä¸€ç±»åŸºç¡€ç½‘ç»œæ¨¡å‹ï¼Œå…¶æ ¸å¿ƒç‰¹å¾æ˜¯ç½‘ç»œè¿æ¥éµå¾ªæŸç§éšæœºç”Ÿæˆè§„åˆ™ã€‚ErdÅ‘s-RÃ©nyiï¼ˆERï¼‰æ¨¡å‹æ˜¯æœ€è‘—åçš„ä»£è¡¨ï¼š

- **å®šä¹‰**ï¼šç»™å®šNä¸ªèŠ‚ç‚¹ï¼Œæ¯å¯¹èŠ‚ç‚¹ä»¥æ¦‚ç‡pç‹¬ç«‹è¿æ¥
- **ç‰¹æ€§**ï¼š
  - åº¦åˆ†å¸ƒå‘ˆæ³Šæ¾åˆ†å¸ƒ $ P(k) \sim e^{-\lambda}\lambda^k/k! $
  - å¹³å‡èšç±»ç³»æ•°ï¼š$C \approx p $
  - å¹³å‡è·¯å¾„é•¿åº¦ï¼š$L \sim \ln(N) $
  
- ç”Ÿç‰©å­¦æ„ä¹‰ï¼š
  - ä½œä¸º"é›¶æ¨¡å‹"ï¼ˆnull modelï¼‰ç”¨äºè¯„ä¼°çœŸå®ç”Ÿç‰©ç½‘ç»œçš„æ˜¾è‘—æ€§
  - å¸®åŠ©è¯†åˆ«ç½‘ç»œä¸­çš„ééšæœºç»“æ„ï¼ˆå¦‚æ¨¡å—ã€æ¢çº½èŠ‚ç‚¹ï¼‰


MetaNetæä¾›ä¸¤ç§éšæœºç½‘ç»œç”Ÿæˆæ–¹æ³•ç”¨äºç½‘ç»œåˆ†æå¯¹æ¯”ï¼š

1. **å•æ¬¡éšæœºç½‘ç»œç”Ÿæˆ**  
ä½¿ç”¨`rand_net()`åŸºäºErdÅ‘s-RÃ©nyiæ¨¡å‹ç”Ÿæˆä¸ç›®æ ‡ç½‘ç»œï¼ˆç›¸åŒèŠ‚ç‚¹æ•°å’Œè¾¹æ•°ï¼‰çš„éšæœºå¯¹ç…§ç½‘ç»œï¼š

```{r}
rand_net(co_net) -> random_net
```

2. **æ‰¹é‡ç”Ÿæˆä¸ç»Ÿè®¡æ¯”è¾ƒ**  
é€šè¿‡`rand_net_par()`ç”Ÿæˆå¤šä¸ªéšæœºç½‘ç»œå¹¶è®¡ç®—æ‹“æ‰‘æŒ‡æ ‡åˆ†å¸ƒï¼Œå†ä½¿ç”¨`compare_rand()`è¿›è¡Œæ˜¾è‘—æ€§æ¯”è¾ƒï¼š
```{r}
rand_net_par(co_net, reps = 30) -> randp  # ç”Ÿæˆ30ä¸ªéšæœºç½‘ç»œ
net_par(co_net) -> pars                   # è®¡ç®—åŸç½‘ç»œæŒ‡æ ‡
compare_rand(pars, randp,                 # æŒ‡æ ‡å¯¹æ¯”
            index = c("Average_path_length", "Clustering_coefficient"))
```

## å¤æ‚ç½‘ç»œ

åœ¨ç»„å­¦ç ”ç©¶ä¸­æ„å»ºçš„ç½‘ç»œå¤§å¤šå±äºå¤æ‚ç½‘ç»œï¼Œå…¶æ ¸å¿ƒç‰¹å¾åŒ…æ‹¬æ— æ ‡åº¦æ€§ã€å°ä¸–ç•Œæ€§ã€æ¨¡å—åŒ–å’Œå±‚æ¬¡æ€§ï¼Œå…·ä½“å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š

![](images/co1.png)

![](images/co2.png)

![](images/complex.png)

1. **æ— æ ‡åº¦æ€§éªŒè¯**  

ä½¿ç”¨`fit_power()`å‡½æ•°æ‹Ÿåˆç½‘ç»œçš„åº¦åˆ†å¸ƒå¹‚å¾‹æ›²çº¿ï¼š

```{r fig.width=5,fig.height=3,out.width='60%'}
data("c_net", package = "MetaNet")
fit_power(co_net)
```

2. **å°ä¸–ç•Œæ€§é‡åŒ–**  
é€šè¿‡`smallworldness()`è®¡ç®—å°ä¸–ç•ŒæŒ‡æ•°Ïƒï¼š

$$
\sigma=\frac{C/C_{random}}{L/L_{random}}
$$
å…¶ä¸­Cå’ŒLåˆ†åˆ«è¡¨ç¤ºå®é™…ç½‘ç»œçš„èšç±»ç³»æ•°å’Œå¹³å‡è·¯å¾„é•¿åº¦ï¼Œ$C_{random}$å’Œ$L_{random}$ä¸ºéšæœºç½‘ç»œå¯¹åº”å€¼ã€‚å½“Ïƒ>1æ—¶ï¼Œç½‘ç»œå…·æœ‰å°ä¸–ç•Œç‰¹æ€§ã€‚

```{r eval=FALSE}
smallworldness(co_net)  # ç¤ºä¾‹è¾“å‡ºï¼š43.09368
```

ç½‘ç»œçš„æ¨¡å—åˆ†æä¸‹ä¸€æ¬¡ä»‹ç»ã€‚

## References
1. Koutrouli M, Karatzas E, Paez-Espino D and Pavlopoulos GA (2020) A Guide to Conquer the Biological Network Era Using Graph Theory. Front. Bioeng. Biotechnol. 8:34. doi: 10.3389/fbioe.2020.00034
2. Faust, K., and Raes, J. (2012). Microbial interactions: from networks to models. Nat. Rev. Microbiol. https://doi.org/10.1038/nrmicro2832.
3. Y. Deng, Y. Jiang, Y. Yang, Z. He, et al., Molecular ecological network analyses. BMC bioinformatics (2012), doi:10.1186/1471-2105-13-113.